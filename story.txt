This is savepoint 2 edited from GitHub version 2. Branch --patch1. Edited to check code--patch3
